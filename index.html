import React, { useState, useEffect } from 'react';

// Main App component
const App = () => {
    // State for the custom message box
    const [message, setMessage] = useState('');
    const [showMessageBox, setShowMessageBox] = useState(false);
    const [isLoading, setIsLoading] = useState(false);

    // Function to show custom message box
    const showCustomMessage = (msg) => {
        setMessage(msg);
        setShowMessageBox(true);
    };

    // Function to close custom message box
    const closeCustomMessageBox = () => {
        setShowMessageBox(false);
    };

    // Form submission handler
    const handleSubmit = async (event) => {
        event.preventDefault(); // Prevent default form submission

        setIsLoading(true); // Show loading state

        const form = event.target;
        const formData = new FormData(form);

        // Add a hidden field for _subject to set the email's subject line
        formData.append('_subject', 'Remote Support Request - Surveillance System');

        try {
            const response = await fetch(form.action, {
                method: form.method,
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            });

            if (response.ok) {
                showCustomMessage('Thank you for your remote support request! We have received your message and will contact you promptly to begin assistance.');
                form.reset(); // Clear the form
            } else {
                const data = await response.json();
                if (Object.hasOwnProperty.call(data, 'errors')) {
                    showCustomMessage('Error: ' + data["errors"].map(error => error["message"]).join(", "));
                } else {
                    showCustomMessage('An unexpected error occurred during submission. Please try again or call us.');
                }
            }
        } catch (error) {
            showCustomMessage('Network error: Could not connect to the server. Please check your internet connection and try again.');
        } finally {
            setIsLoading(false); // Hide loading state
        }
    };

    // Effect to initialize Lucide Icons on component mount
    useEffect(() => {
        // Ensure lucide is defined before calling createIcons
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }
    }, [isLoading]); // Re-create icons if loading state changes (for button icon)

    return (
        <div className="min-h-screen bg-zinc-950 text-zinc-100 p-4 sm:p-6 font-inter">
            <div className="max-w-5xl mx-auto bg-zinc-900 rounded-3xl shadow-2xl border border-zinc-800 p-8 sm:p-14 my-10">

                {/* Header Section */}
                <h1 className="text-4xl sm:text-5xl font-extrabold text-blue-500 mb-8 sm:mb-12 flex flex-col sm:flex-row items-center justify-center text-center gap-3 sm:gap-4 leading-tight">
                    <i data-lucide="cloud-cog" className="w-16 h-16 text-blue-600 drop-shadow-lg"></i>
                    <span>Premier Remote Surveillance System Support & Optimization</span>
                </h1>
                <p className="text-lg sm:text-xl mb-12 sm:mb-16 text-zinc-400 text-center max-w-4xl mx-auto">
                    Receive expert **online and remote support** for all major security camera brands. We connect directly via manufacturer remote portals to **check system health, improve performance, ensure continuous recording, and verify online status**. Experience peace of mind with reliable, distant assistance.
                </p>

                {/* Remote Support Services Section */}
                <section className="mb-12 sm:mb-16">
                    <h2 className="text-3xl sm:text-4xl font-bold text-center text-blue-500 mb-8 sm:mb-12">Our Remote Support Capabilities</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8">
                        <ServiceCard
                            icon="activity"
                            title="System Health & Performance Checks"
                            description="We remotely connect to your security camera system to perform comprehensive health diagnostics and optimize its performance. This includes checking component integrity, resource utilization, and overall system responsiveness to ensure smooth operation."
                        />
                        <ServiceCard
                            icon="video-off"
                            title="Recording & Playback Verification"
                            description="Ensure your valuable footage is always being captured and stored correctly. We remotely verify recording functionality, troubleshoot playback issues, and configure storage settings to prevent data loss and ensure compliance."
                        />
                        <ServiceCard
                            icon="cloud-off"
                            title="Online Status & Connectivity Assurance"
                            description="Is your system offline? We diagnose and resolve remote access issues, network connectivity problems, and ensure your security cameras and recording devices are consistently online and accessible through their respective manufacturer portals."
                        />
                        <ServiceCard
                            icon="settings"
                            title="Configuration & Feature Optimization"
                            description="Our specialists remotely adjust camera settings, refine motion detection zones, manage user permissions, and optimize advanced features to ensure your surveillance system meets your specific security needs and operates at peak efficiency."
                        />
                        <ServiceCard
                            icon="upload-cloud"
                            title="Firmware Updates & Software Maintenance"
                            description="Keep your system secure and up-to-date. We remotely perform crucial firmware updates for cameras, DVRs, and NVRs, apply software patches, and resolve compatibility issues to enhance system stability and security."
                        />
                        <ServiceCard
                            icon="key"
                            title="Password & Access Recovery"
                            description="Lost access to your system? We provide secure remote assistance for password resets, account recovery, and re-establishing secure access credentials, ensuring only authorized personnel can view and manage your surveillance."
                        />
                    </div>
                </section>

                {/* How Remote Support Works Section */}
                <section className="mb-12 sm:mb-16">
                    <h2 className="text-3xl sm:text-4xl font-bold text-center text-blue-500 mb-8 sm:mb-12">How Our Remote Support Works</h2>
                    <div className="info-box bg-zinc-800 border-l-8 border-purple-500 rounded-lg p-6 sm:p-8 shadow-inner">
                        <p className="text-lg text-zinc-200 leading-relaxed mb-4">
                            Our remote support process is designed for efficiency and security.
                            Once you initiate a request, we will guide you to grant us temporary, secure access to your system via its manufacturer's designated remote portal (e.g., Hik-Connect, Dahua P2P, Axis Companion).
                        </p>
                        <p className="text-base text-zinc-300 leading-relaxed mb-4">
                            This direct connection allows our certified technicians to diagnose issues, adjust settings, and perform maintenance tasks without needing an on-site visit.
                            You maintain full control and can revoke access at any time.
                        </p>
                        <p className="text-sm text-zinc-400 leading-relaxed">
                            This method ensures rapid response times, cost-effectiveness, and minimizes disruption to your property.
                        </p>
                    </div>
                </section>

                {/* Pricing & Payment Integration */}
                <section className="mb-12 sm:mb-16">
                    <h2 className="text-3xl sm:text-4xl font-bold text-center text-blue-500 mb-8 sm:mb-12">Flexible Remote Service & Payment Options</h2>
                    <p className="text-lg text-zinc-300 text-center mb-8">
                        Choose the remote support package that best fits your needs. All payments are securely processed via Stripe.
                    </p>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8">
                        <div className="service-card p-6">
                            <h4 className="text-2xl font-bold text-blue-300 mb-4">Remote Diagnostic Session</h4>
                            <p className="text-zinc-300 text-base mb-6">
                                A single session for diagnosing specific issues, minor configuration adjustments, or verifying system status.
                            </p>
                            <p className="text-orange-400 font-extrabold text-4xl mb-6">One-Time: $99</p>
                            <a href="YOUR_STRIPE_REMOTE_DIAGNOSTIC_LINK" target="_blank" rel="noopener noreferrer" className="btn-primary w-full">
                                <i data-lucide="credit-card" className="mr-3 w-5 h-5"></i> Purchase Session
                            </a>
                        </div>
                        <div className="service-card p-6">
                            <h4 className="text-2xl font-bold text-blue-300 mb-4">Annual Remote Optimization Plan</h4>
                            <p className="text-zinc-300 text-base mb-6">
                                Includes quarterly health checks, priority remote support, firmware updates, and performance tuning throughout the year.
                            </p>
                            <p className="text-orange-400 font-extrabold text-4xl mb-6">Annual: $399</p>
                            <a href="YOUR_STRIPE_ANNUAL_PLAN_LINK" target="_blank" rel="noopener noreferrer" className="btn-primary w-full">
                                <i data-lucide="calendar-check" className="mr-3 w-5 h-5"></i> Subscribe Now
                            </a>
                        </div>
                    </div>
                    <p className="text-sm text-zinc-500 text-center mt-8">
                        *Note: Payments are securely processed via Stripe. Click a button to be redirected to our secure checkout page.
                    </p>
                </section>

                {/* Contact Section */}
                <section id="contactForm" className="mt-12 sm:mt-16 text-center">
                    <h2 className="text-3xl sm:text-4xl font-bold text-center text-blue-500 mb-8 sm:mb-12">Initiate Remote Support Request</h2>
                    
                    <p className="text-lg text-zinc-300 mb-8">
                        For urgent remote support, you can also contact our specialists directly:
                    </p>
                    <p className="text-4xl sm:text-5xl font-extrabold text-orange-400 mb-10 sm:mb-12">
                        <a href="tel:+12163338245" className="hover:underline flex items-center justify-center group">
                            <i data-lucide="phone-call" className="inline-block mr-4 sm:mr-5 w-10 h-10 sm:w-12 sm:h-12 transition-transform duration-300 group-hover:scale-110"></i> 216-333-8245
                        </a>
                    </p>

                    <p className="text-lg text-zinc-300 mb-8 sm:mb-10">
                        Alternatively, complete the inquiry form below to schedule your remote support session or for a detailed consultation. Our team will respond promptly.
                    </p>

                    <div className="form-container">
                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label htmlFor="fullName">Your Full Name:</label>
                                <input type="text" id="fullName" name="name" required placeholder="Johnathan Doe" className="block w-full px-4 py-3 bg-zinc-800 border border-blue-500 rounded-lg text-zinc-100 focus:ring-2 focus:ring-blue-600 focus:border-blue-600" />
                            </div>
                            <div className="form-group">
                                <label htmlFor="emailAddress">Your Professional Email Address:</label>
                                <input type="email" id="emailAddress" name="email" required placeholder="your.email@example.com" className="block w-full px-4 py-3 bg-zinc-800 border border-blue-500 rounded-lg text-zinc-100 focus:ring-2 focus:ring-blue-600 focus:border-blue-600" />
                            </div>
                            <div className="form-group">
                                <label htmlFor="phoneNumber">Your Direct Phone Number:</label>
                                <input type="tel" id="phoneNumber" name="phone" placeholder="(123) 456-7890" className="block w-full px-4 py-3 bg-zinc-800 border border-blue-500 rounded-lg text-zinc-100 focus:ring-2 focus:ring-blue-600 focus:border-blue-600" />
                            </div>
                            <div className="form-group">
                                <label htmlFor="cameraBrand">Security Camera System Brand:</label>
                                <input type="text" id="cameraBrand" name="camera_brand" required placeholder="e.g., Hikvision, Dahua, Axis, Lorex, Arlo, Ring, Nest" className="block w-full px-4 py-3 bg-zinc-800 border border-blue-500 rounded-lg text-zinc-100 focus:ring-2 focus:ring-blue-600 focus:border-blue-600" />
                            </div>
                            <div className="form-group">
                                <label htmlFor="systemType">System Type (e.g., NVR, DVR, Cloud-based):</label>
                                <input type="text" id="systemType" name="system_type" placeholder="e.g., NVR, DVR, Cloud, Standalone IP Camera" className="block w-full px-4 py-3 bg-zinc-800 border border-blue-500 rounded-lg text-zinc-100 focus:ring-2 focus:ring-blue-600 focus:border-blue-600" />
                            </div>
                            <div className="form-group">
                                <label htmlFor="message">Detailed Description of Issue / Support Needed:</label>
                                <textarea id="message" name="message" rows="7" required placeholder="Please describe the issue you are experiencing, what remote support you require, or specific performance checks needed." className="block w-full px-4 py-3 bg-zinc-800 border border-blue-500 rounded-lg text-zinc-100 focus:ring-2 focus:ring-blue-600 focus:border-blue-600"></textarea>
                            </div>
                            <div className="text-center mt-8 sm:mt-12">
                                <button type="submit" className="btn-primary" disabled={isLoading}>
                                    {isLoading ? (
                                        <>
                                            Submitting...
                                            <span className="loading-spinner ml-3"></span>
                                        </>
                                    ) : (
                                        <>
                                            Submit Remote Support Request
                                            <i data-lucide="send" className="inline-block ml-3 sm:ml-4 w-5 h-5 sm:w-6 h-6"></i>
                                        </>
                                    )}
                                </button>
                            </div>
                        </form>
                    </div>
                </section>
            </div>

            {/* Custom Message Box */}
            {showMessageBox && (
                <div id="messageBox" className="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-zinc-800 text-zinc-100 p-8 rounded-lg shadow-xl border-2 border-blue-500 z-50 animate-fadeIn">
                    <p id="messageText" className="text-lg mb-6">{message}</p>
                    <button onClick={closeCustomMessageBox} className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-md transition-colors">OK</button>
                </div>
            )}
        </div>
    );
};

// ServiceCard Component (reusable for different service types)
const ServiceCard = ({ icon, title, description, colSpan = '' }) => {
    return (
        <div className={`service-card bg-zinc-800 border border-zinc-700 rounded-xl p-6 sm:p-8 shadow-lg transition-all duration-300 ease-in-out hover:scale-105 hover:shadow-2xl flex flex-col items-center text-center ${colSpan}`}>
            <i data-lucide={icon} className="w-16 h-16 text-blue-400 mb-5 sm:mb-6 flex-shrink-0"></i>
            <h4 className="text-xl sm:text-2xl font-bold text-blue-300 mb-4">{title}</h4>
            <p className="text-zinc-300 text-sm sm:text-base leading-relaxed flex-grow">{description}</p>
        </div>
    );
};

export default App;
